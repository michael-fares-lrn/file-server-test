(()=>{"use strict";var e="lrn-custom-question",n="lrn_correct",t="lrn_incorrect";function r(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}function s(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var i=function(){function i(e,n){var t=this;!function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,i),this.init=e,this.events=e.events,this.lrnUtils=n,this.el=e.$el.get(0),this.render().then((function(){t.registerPublicMethods(),t.handleEvents();var n=e.state,r=e.response,s=t.el;"resume"!==n&&"review"!==n||!r||Array.from(s.querySelectorAll(".response-input")).forEach((function(n,t){n.value=e.response[t]})),"review"===n&&e.getFacade().disable(),e.events.trigger("ready")}))}var o,a;return o=i,(a=[{key:"render",value:function(){var n=this,t=this.el,s=this.init,i=this.lrnUtils,o=s.question;return s.response,t.innerHTML='\n            <div class="'.concat(e,' lrn-response-validation-wrapper">\n                <div class="lrn_response_input">\n                    \n                </div>            \n                <div class="').concat(e,'-checkAnswer-wrapper"></div>\n                <div class="').concat(e,'-suggestedAnswers-wrapper"></div>\n            </div>\n        '),Promise.all([i.renderComponent("SuggestedAnswersList",t.querySelector(".".concat(e,"-suggestedAnswers-wrapper"))),i.renderComponent("CheckAnswerButton",t.querySelector(".".concat(e,"-checkAnswer-wrapper")))]).then((function(s){var i,a,l=(i=s,a=1,function(e){if(Array.isArray(e))return e}(i)||function(e,n){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var r,s,i=[],o=!0,a=!1;try{for(t=t.call(e);!(o=(r=t.next()).done)&&(i.push(r.value),!n||i.length!==n);o=!0);}catch(e){a=!0,s=e}finally{try{o||null==t.return||t.return()}finally{if(a)throw s}}return i}}(i,a)||function(e,n){if(e){if("string"==typeof e)return r(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?r(e,n):void 0}}(i,a)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())[0];n.suggestedAnswersList=l;var c=t.querySelector(".lrn_response_input"),u=/{{response}}/g;o.template.split(" ").join(" ").split("&nbsp;").join(" ").split(" ").forEach((function(n){var t=n.match(u);c.innerHTML+=t?'<input class="'.concat(e,' response-input" type="text"></input>&nbsp;'):"".concat(n)})),console.log("responseArea.innerHTML after loop",c.innerHTML)}))}},{key:"registerPublicMethods",value:function(){var e=this,r=this.init,s=this.el,i=r.getFacade(),o=s.querySelector(".lrn_response_input"),a=Array.from(s.querySelectorAll(".response-input"));i.disable=function(){a.forEach((function(e){e.setAttribute("disabled",!0),e.classList.add("disabled")}))},i.enable=function(){a.forEach((function(e){e.removeAttribute("disabled"),e.classList.remove("disabled")}))},i.resetResponse=function(){a.forEach((function(e){e.value=""})),e.events.trigger("resetResponse")},i.showValidationUI=function(){var e=i.isValid(!0).correct,r=i.isValid(!0).partial;e?o.classList.add(n):(console.log(r),o.classList.add(t),a.forEach((function(e,s){console.log("index",s),console.log("partialValidation[index]",r[s]),!0===r[s]?e.classList.add(n):e.classList.add(t)})))},i.resetValidationUI=function(){o.classList.remove(n),o.classList.remove(t),a.forEach((function(e){e.classList.remove(n),e.classList.remove(t)})),e.suggestedAnswersList&&e.suggestedAnswersList.reset()}}},{key:"handleEvents",value:function(){var e=this,n=this.events,t=this.init,r=this.el,s=t.getFacade(),i=t.response||[];Array.from(r.querySelectorAll(".response-input")).forEach((function(e,t){e.addEventListener("input",(function(e){i[t]=e.target.value,n.trigger("changed",i),console.log(s.getResponse()),s.resetValidationUI()}))})),n.on("validate",(function(n){var t=e.suggestedAnswersList,r=e.init.question;console.log(s.getScore()),s.showValidationUI(),n.showCorrectAnswers&&t&&(t.reset(),t.setAnswers(r.validation.valid_response.value.map((function(e,n){return{index:n,label:e.value}}))))}))}}])&&s(o.prototype,a),i}();LearnosityAmd.define([],(function(){return{Question:i}}))})();